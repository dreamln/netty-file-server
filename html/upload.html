
<!doctype html>
<head>
<title>File Upload Progress Demo #1</title>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<style>
body{padding-top: 50px;}
</style>
</head>
<body>
    
    <div class="container">
        <div class="well">
            <h1>Ajax File Upload</h1>
        	
            <form role="form" action="http://localhost:8080" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="fileInput">File</label>
                    <input type="file" name="myfile" class="form-control" id="fileInput">
                </div>
                <button type="submit" class="btn btn-primary">Upload File to Server</button>
            </form>
            <br />
            <div class="progress progress-striped active">
                <div class="progress-bar"  role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">
                    <span class="sr-only">0%</span>
                </div>
            </div>
            
            <div id="status"></div>
        </div>
    </div>

<script>
(function() {
    
var bar = $('.progress-bar');
var barParent = $('.progress');
var percent = $('.sr-only');
var status = $('#status');
   
$('form').ajaxForm({
    crossDomain: true,
    beforeSend: function() {
        status.empty();
        barParent.show();
        var percentVal = '0%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    uploadProgress: function(event, position, total, percentComplete) {
        var percentVal = percentComplete + '%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    success: function() {
        var percentVal = '100%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
	complete: function(xhr) {
		//console.log(xhr.responseText);
        barParent.hide();
        var responseObj = JSON.parse(xhr.responseText);
        
        status.html('<a href="http://localhost:8080?file=' + responseObj.file+'" target="_blank">Open</a>');
	}
}); 

})();       
</script>